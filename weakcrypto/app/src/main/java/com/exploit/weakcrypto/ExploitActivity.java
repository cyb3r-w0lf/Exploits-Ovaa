package com.exploit.weakcrypto;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.os.Bundle;
import android.util.Base64;
import android.util.Log;
import android.widget.Toast;

import androidx.annotation.Nullable;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public class ExploitActivity extends Activity {
    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        String url = getIntent().getStringExtra("url");
        String token = url.split("token=")[1];
        Log.i("LOG","encryptedToken: " + token);
        Toast.makeText(this,"Encrypted Token: "+token,Toast.LENGTH_LONG).show();

        try {
            String KEY = "49u5gh249gh24985ghf429gh4ch8f23f";
            SecretKeySpec secretKeySpec = new SecretKeySpec(KEY.getBytes(), "AES");
            @SuppressLint("GetInstance") Cipher instance = Cipher.getInstance("AES");
            instance.init(2, secretKeySpec);
            String decrypted = new String(instance.doFinal(Base64.decode(token,0)));
            Log.i("LOG","DecryptedToken: " + decrypted);
            Toast.makeText(this,"Decryped= "+decrypted,Toast.LENGTH_LONG).show();
        } catch (Exception e){
            e.printStackTrace();
        }
    }
}
